# Biscuit Cracker

В этом проекте я научисля делать следующие вещи:
- Полный цикл запуска и перезапуска игры
- Управление порядком обновления объектов (ITick)
- Использование UnityEvents для связки игровых менеджеров (игровые объекты, интерфейс, звуки, логика игры)
- Использование DOTween для плавных анимаций кликов
- Использование ScriptableObjects для контроллера звуков
- Создание прокачки параметров (увеличение спада шума)
- Отображение динамического интерфейса (количество кликов по печенью)

Проект использует 3D пространтсво за основу. Для 2D объектов взята плоскость XZ.

## Управление обновлениями (ITick) ##

Управление обновлениями (ITick), ака Тик. 

Тики понадобились для реализации паузы в игре. Чтобы достичь полного контроля над вызовом методов Update - я перевел зависимые от времени объекты на Тики.

Тики контролирует GameManager. В нём обязательно нужно регистрировать все объекты на Тиках. Для регистрации есть методы RegisterTickObject, списки List<ITick> TickRegisteredObjects и List<ITick> TickObjectsToRemove. 

<img width="612" height="559" alt="image" src="https://github.com/user-attachments/assets/04693c7f-8cb0-4754-8a67-e59ac3676c2a" />

Объектам не нужно напрямую сообщать о своём уничтожении. Достаточно вызвать Destroy метод из интерфейса ITick.

Объект будет убран из списках Тиков только в следующем кадре. Так сделано, чтобы не нарушать целостность списка Тиков во время обновления.

<img width="848" height="441" alt="image" src="https://github.com/user-attachments/assets/f3f1af37-592f-4511-885d-944dbb3c8e2e" />

## События UnityEvents

Мне очень понравилось использовать UnityEvents для связывания игровых сущностей и интерфейса. 

События полностью поддерживаются редактором и это сильно упрощает управление игровым циклом. Так, используя UnityEvents для связи XXXManager и YYYUI, нет нужды в скриптах писать поиск и проверки компонентов, логику вызоыва и очистки событий.

Просто взял и связал.

<img width="431" height="353" alt="image" src="https://github.com/user-attachments/assets/2b30cf89-8bd8-4dba-9b8a-35ae51c99bd6" />

## DOTWeen и визуал ##

При клике по пченью, сам объект Biscuit ничего не анимирует. Biscuit запускает событие OnClick.

<img width="696" height="213" alt="image" src="https://github.com/user-attachments/assets/5170a604-bd21-4423-b19c-e9af4e36499c" />

Событие OnClick вызывает метод Impress у компонента BiscuitImpress. Этот компонент отвечает за анимации и визуал. 

Так визульная состовляющая отделена от _данных _и_ логики_.

<img width="807" height="310" alt="image" src="https://github.com/user-attachments/assets/5d4a88c6-f975-4f1c-96be-953085e5d11d" />

## Управление звуком ##

Звук управляется через SoundManager. Он создает экземпляры Gameobject для каждого звука, включающий:
- AudioSource. Стандартный компонент Unity для проигрывания звука.
- SoundController. Нужен для отсчета времени проигрывания и для запуска проигрывания (AudioSource) звука.

SoundManager, чтобы воспроизвести звук, смотрит какие контролеры уже существуют, можно ли их прервать и нужно ли создавать ещё один SoundController для идентичного звука. 

<img width="989" height="659" alt="image" src="https://github.com/user-attachments/assets/21ec75e1-1084-4435-8b28-102da9ee48c0" />

Использовал ScriptableObjects для редактирования звуковых эффектов. 

Каждый звук имеет настройки прерывания. Использую временной порог (treshold), чтобы избежать резкого прерывания при частых кликах. Если прерывание разрешено, но порог не преодолен, то звук не будет проигрываться. 

SoundController`ы повторяют друг друга, если в конифгурации звука запрещено прерывание.

<img width="437" height="190" alt="image" src="https://github.com/user-attachments/assets/da3e7ae6-2cb5-49d1-84de-6fa1fe723e03" />


## Прокачка ##

Прокачка реализована через функции Func<T1,T2> - передается исходное значение и на выходе уже измененное. У NoiseManager есть список функций-модификаторов. Каждый кадр формируется значение decayRate, проходящее через все модификаторы.

Перед формированием значения decayRate - вызывается событие BeforeNoiseDecay. На это событие отзываются все сущности _(указанные в инспекторе в слушателях этого события)_, которые хотят повлиять на decayRate. 

Сущность Upgrade создана отдельным объектом на сцене и имеет ссылку на NoiseManager. Upgrade добавляет свою функцию изменения (модификатор) decayRate в список модификаторов NoiseManager.

Список всех добавленных модификаторов очищается после их вызова.

<img width="433" height="123" alt="image" src="https://github.com/user-attachments/assets/0cba352b-aed5-4e19-a057-87381fffb299" />

<img width="510" height="262" alt="image" src="https://github.com/user-attachments/assets/bd871274-a51e-482a-9be7-7684a4ca43d7" />


## Скриншоты ##

На скриншоте видны печенья и интерфейс прокачки.

<img width="1920" height="1080" alt="image" src="https://github.com/user-attachments/assets/1697ea77-0870-4fca-90aa-3c76e4495503" />
